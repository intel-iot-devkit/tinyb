set (tinyb_hci_LIB_INCLUDE_DIRS
  ${PROJECT_SOURCE_DIR}/api
  ${PROJECT_SOURCE_DIR}/api/tinyb_hci
  ${PROJECT_SOURCE_DIR}/include
)

include_directories(
  ${tinyb_hci_LIB_INCLUDE_DIRS}
  ${CMAKE_CURRENT_BINARY_DIR}
)

set (tinyb_hci_LIB_SRCS
  ${PROJECT_SOURCE_DIR}/src/tinyb_hci/BasicTypes.cpp
  ${PROJECT_SOURCE_DIR}/src/tinyb_hci/UUID.cpp
  ${PROJECT_SOURCE_DIR}/src/tinyb_hci/BTDataTypes.cpp
  ${PROJECT_SOURCE_DIR}/src/tinyb_hci/HCIAdapter.cpp
  ${PROJECT_SOURCE_DIR}/src/tinyb_hci/HCIDevice.cpp
# autogenerated files
  ${CMAKE_CURRENT_BINARY_DIR}/../version.c
)

add_library (tinyb_hci SHARED ${tinyb_hci_LIB_SRCS})
target_link_libraries (
  tinyb_hci
  ${CMAKE_THREAD_LIBS_INIT}
  bluetooth
)

set_target_properties(
   tinyb_hci
   PROPERTIES
   SOVERSION ${tinyb_VERSION_MAJOR}
   VERSION ${tinyb_VERSION_STRING}
   CXX_STANDARD 11
)
install (DIRECTORY ${PROJECT_SOURCE_DIR}/api/tinyb_hci/ DESTINATION include/tinyb_hci)

macro (tinyb_CREATE_INSTALL_PKGCONFIG generated_file install_location)
  configure_file (${generated_file}.cmake ${CMAKE_CURRENT_BINARY_DIR}/${generated_file} @ONLY)
  install (FILES ${CMAKE_CURRENT_BINARY_DIR}/${generated_file} DESTINATION ${install_location})
endmacro (tinyb_CREATE_INSTALL_PKGCONFIG)
tinyb_create_install_pkgconfig (tinyb_hci.pc lib${LIB_SUFFIX}/pkgconfig)

install(TARGETS tinyb_hci LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR})

