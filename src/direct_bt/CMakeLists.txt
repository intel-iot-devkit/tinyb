set (direct_bt_LIB_INCLUDE_DIRS
  ${PROJECT_SOURCE_DIR}/api
  ${PROJECT_SOURCE_DIR}/api/direct_bt
  ${PROJECT_SOURCE_DIR}/include
)

include_directories(
  ${direct_bt_LIB_INCLUDE_DIRS}
  ${CMAKE_CURRENT_BINARY_DIR}
)

set (direct_bt_LIB_SRCS
  ${PROJECT_SOURCE_DIR}/src/direct_bt/dfa_utf8_decode.cpp
  ${PROJECT_SOURCE_DIR}/src/ieee11073/DataTypes.cpp
  ${PROJECT_SOURCE_DIR}/src/direct_bt/BasicTypes.cpp
  ${PROJECT_SOURCE_DIR}/src/direct_bt/UUID.cpp
  ${PROJECT_SOURCE_DIR}/src/direct_bt/BTTypes.cpp
  ${PROJECT_SOURCE_DIR}/src/direct_bt/HCIComm.cpp
  ${PROJECT_SOURCE_DIR}/src/direct_bt/HCITypes.cpp
  ${PROJECT_SOURCE_DIR}/src/direct_bt/HCIHandler.cpp
  ${PROJECT_SOURCE_DIR}/src/direct_bt/L2CAPComm.cpp
  ${PROJECT_SOURCE_DIR}/src/direct_bt/MgmtTypes.cpp
  ${PROJECT_SOURCE_DIR}/src/direct_bt/DBTManager.cpp
  ${PROJECT_SOURCE_DIR}/src/direct_bt/DBTTypes.cpp
  ${PROJECT_SOURCE_DIR}/src/direct_bt/DBTAdapter.cpp
  ${PROJECT_SOURCE_DIR}/src/direct_bt/DBTDevice.cpp
  ${PROJECT_SOURCE_DIR}/src/direct_bt/ATTPDUTypes.cpp
  ${PROJECT_SOURCE_DIR}/src/direct_bt/GATTNumbers.cpp
  ${PROJECT_SOURCE_DIR}/src/direct_bt/GATTDescriptor.cpp
  ${PROJECT_SOURCE_DIR}/src/direct_bt/GATTCharacteristic.cpp
  ${PROJECT_SOURCE_DIR}/src/direct_bt/GATTService.cpp
  ${PROJECT_SOURCE_DIR}/src/direct_bt/GATTHandler.cpp
# autogenerated files
  ${CMAKE_CURRENT_BINARY_DIR}/../version.c
)

add_library (direct_bt SHARED ${direct_bt_LIB_SRCS})
target_link_libraries (
  direct_bt
  ${CMAKE_THREAD_LIBS_INIT}
)

set_target_properties(
   direct_bt
   PROPERTIES
   SOVERSION ${tinyb_VERSION_MAJOR}
   VERSION ${tinyb_VERSION_STRING}
   CXX_STANDARD 11
   COMPILE_FLAGS "-Wall -Wextra -Werror"
)
install (DIRECTORY ${PROJECT_SOURCE_DIR}/api/direct_bt/ DESTINATION include/direct_bt)

macro (tinyb_CREATE_INSTALL_PKGCONFIG generated_file install_location)
  configure_file (${generated_file}.cmake ${CMAKE_CURRENT_BINARY_DIR}/${generated_file} @ONLY)
  install (FILES ${CMAKE_CURRENT_BINARY_DIR}/${generated_file} DESTINATION ${install_location})
endmacro (tinyb_CREATE_INSTALL_PKGCONFIG)
tinyb_create_install_pkgconfig (direct_bt.pc lib${LIB_SUFFIX}/pkgconfig)

install(TARGETS direct_bt LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR})

